import streamlit as st
import pandas as pd
import plotly.express as px
import plotly.graph_objects as go
import random

# =================== –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø ===================
st.set_page_config(page_title="Game Balance AI", layout="wide")

# –î–µ–º–æ-–¥–∞–Ω–Ω—ã–µ
HEROES = ["Axe", "–î–∂–∞–≥–≥–µ—Ä–Ω–∞—É—Ç", "Invoker", "Cristal maiden", "Pudge"]
PARAMS = ["–£—Ä–æ–Ω", "–ó–¥–æ—Ä–æ–≤—å–µ", "–°–∫–æ—Ä–æ—Å—Ç—å –∞—Ç–∞–∫–∏", "–ë—Ä–æ–Ω—è", "–ú–∞–Ω–∞"]

# =================== –ó–ê–ì–û–õ–û–í–û–ö ===================
st.title("üéÆ –ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∞–Ω–∞–ª–∏–∑–∞ –±–∞–ª–∞–Ω—Å–∞ –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞")
st.markdown("---")

# =================== –í–ö–õ–ê–î–ö–ò ===================
tab1, tab2, tab3, tab4 = st.tabs(["–î–∞—à–±–æ—Ä–¥", "–ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞", "–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –∫–æ–Ω—Ç–µ–Ω—Ç–∞", "–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö"])

# =================== –í–ö–õ–ê–î–ö–ê 1: –î–ê–®–ë–û–†–î ===================
with tab1:
    st.header("–û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±–∞–ª–∞–Ω—Å–∞")
    
    # –î–µ–º–æ-–¥–∞–Ω–Ω—ã–µ –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–æ–≤
    winrates = {hero: round(random.uniform(40, 60), 1) for hero in HEROES}
    pickrates = {hero: random.randint(5, 30) for hero in HEROES}
    
    df_winrate = pd.DataFrame(list(winrates.items()), columns=["–ì–µ—Ä–æ–π", "–í–∏–Ω—Ä–µ–π—Ç (%)"])
    df_pickrate = pd.DataFrame(list(pickrates.items()), columns=["–ì–µ—Ä–æ–π", "–ß–∞—Å—Ç–æ—Ç–∞ –≤—ã–±–æ—Ä–∞ (%)"])
    
    col1, col2 = st.columns(2)
    
    with col1:
        st.subheader("–¢–æ–ø-5 –≥–µ—Ä–æ–µ–≤ –ø–æ –≤–∏–Ω—Ä–µ–π—Ç—É")
        fig1 = px.bar(df_winrate.sort_values(by="–í–∏–Ω—Ä–µ–π—Ç (%)", ascending=False), 
                      x="–ì–µ—Ä–æ–π", y="–í–∏–Ω—Ä–µ–π—Ç (%)", color="–í–∏–Ω—Ä–µ–π—Ç (%)")
        st.plotly_chart(fig1, use_container_width=True)
    
    with col2:
        st.subheader("–ü–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç—å –≥–µ—Ä–æ–µ–≤")
        fig2 = px.pie(df_pickrate, names="–ì–µ—Ä–æ–π", values="–ß–∞—Å—Ç–æ—Ç–∞ –≤—ã–±–æ—Ä–∞ (%)")
        st.plotly_chart(fig2, use_container_width=True)
    
    st.subheader("–û—Ç—á—ë—Ç –æ –¥–∏—Å–±–∞–ª–∞–Ω—Å–µ")
    imbalance_report = {
        "–ì–µ—Ä–æ–π": ["–ê–∫—Å", "–î–∂–∞–≥–≥–µ—Ä–Ω–∞—É—Ç", "–ò–Ω–≤–æ–∫–µ—Ä"],
        "–ü—Ä–æ–±–ª–µ–º–∞": ["–°–ª–∏—à–∫–æ–º –≤—ã—Å–æ–∫–∏–π –≤–∏–Ω—Ä–µ–π—Ç", "–ù–∏–∑–∫–∞—è –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç—å", "–°–∏–ª—å–Ω–∞—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç –º–∞–Ω—ã"],
        "–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è": ["–£–º–µ–Ω—å—à–∏—Ç—å —É—Ä–æ–Ω –Ω–∞ 5%", "–£–≤–µ–ª–∏—á–∏—Ç—å –±–∞–∑–æ–≤–æ–µ –∑–¥–æ—Ä–æ–≤—å–µ", "–£–º–µ–Ω—å—à–∏—Ç—å —Å—Ç–æ–∏–º–æ—Å—Ç—å —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–µ–π"]
    }
    st.table(pd.DataFrame(imbalance_report))

# =================== –í–ö–õ–ê–î–ö–ê 2: –ë–ê–õ–ê–ù–°–ò–†–û–í–ö–ê ===================
with tab2:
    st.header("What-if –∞–Ω–∞–ª–∏–∑ –±–∞–ª–∞–Ω—Å–∞")
    
    # –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –≥–µ—Ä–æ—è
    HERO_STATS = {
        "Axe": {
            "–ó–¥–æ—Ä–æ–≤—å–µ": 720,
            "–ë—Ä–æ–Ω—è": 4.5,
            "–£—Ä–æ–Ω": 75,
            "–°–∫–æ—Ä–æ—Å—Ç—å –∞—Ç–∞–∫–∏": 100,
            "–ú–∞–Ω–∞": 150
        },
        "–î–∂–∞–≥–≥–µ—Ä–Ω–∞—É—Ç": {
            "–ó–¥–æ—Ä–æ–≤—å–µ": 680,
            "–ë—Ä–æ–Ω—è": 2.0,
            "–£—Ä–æ–Ω": 95,
            "–°–∫–æ—Ä–æ—Å—Ç—å –∞—Ç–∞–∫–∏": 140,
            "–ú–∞–Ω–∞": 120
        },
        "Invoker": {
            "–ó–¥–æ—Ä–æ–≤—å–µ": 620,
            "–ë—Ä–æ–Ω—è": 0.5,
            "–£—Ä–æ–Ω": 55,
            "–°–∫–æ—Ä–æ—Å—Ç—å –∞—Ç–∞–∫–∏": 80,
            "–ú–∞–Ω–∞": 350
        },
        "Cristal maiden": {
            "–ó–¥–æ—Ä–æ–≤—å–µ": 600,
            "–ë—Ä–æ–Ω—è": 1.0,
            "–£—Ä–æ–Ω": 50,
            "–°–∫–æ—Ä–æ—Å—Ç—å –∞—Ç–∞–∫–∏": 70,
            "–ú–∞–Ω–∞": 300
        },
        "Pudge": {
            "–ó–¥–æ—Ä–æ–≤—å–µ": 800,
            "–ë—Ä–æ–Ω—è": 3.0,
            "–£—Ä–æ–Ω": 85,
            "–°–∫–æ—Ä–æ—Å—Ç—å –∞—Ç–∞–∫–∏": 90,
            "–ú–∞–Ω–∞": 180
        }
    }
    
    hero = st.selectbox("–í—ã–±–µ—Ä–∏—Ç–µ –≥–µ—Ä–æ—è:", HEROES, key="balance_hero")
    
    st.subheader(f"–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –≥–µ—Ä–æ—è: {hero}")
    
    # –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â–∏–µ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –≥–µ—Ä–æ—è
    current_params = HERO_STATS[hero]
    
    col1, col2 = st.columns(2)
    proposed_params = {}
    
    with col1:
        st.write("**–¢–µ–∫—É—â–∏–µ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è:**")
        # –û—Ç–æ–±—Ä–∞–∂–∞–µ–º —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
        st.metric("–ó–¥–æ—Ä–æ–≤—å–µ", f"{current_params['–ó–¥–æ—Ä–æ–≤—å–µ']} HP", 
                 delta=None, help="–ë–∞–∑–æ–≤–æ–µ –∑–¥–æ—Ä–æ–≤—å–µ –Ω–∞ —É—Ä–æ–≤–Ω–µ 1")
        st.metric("–ë—Ä–æ–Ω—è", f"{current_params['–ë—Ä–æ–Ω—è']}", 
                 delta=None, help="–ë–∞–∑–æ–≤–∞—è –±—Ä–æ–Ω—è (–º–æ–∂–µ—Ç –±—ã—Ç—å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–π)")
        st.metric("–£—Ä–æ–Ω", f"{current_params['–£—Ä–æ–Ω']}", 
                 delta=None, help="–ë–∞–∑–æ–≤—ã–π —É—Ä–æ–Ω –ø—Ä–∏ –∞—Ç–∞–∫–µ")
        st.metric("–°–∫–æ—Ä–æ—Å—Ç—å –∞—Ç–∞–∫–∏", f"{current_params['–°–∫–æ—Ä–æ—Å—Ç—å –∞—Ç–∞–∫–∏']}", 
                 delta=None, help="–ë–∞–∑–æ–≤–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å –∞—Ç–∞–∫–∏ (—á–µ–º –≤—ã—à–µ, —Ç–µ–º –±—ã—Å—Ç—Ä–µ–µ)")
        st.metric("–ú–∞–Ω–∞", f"{current_params['–ú–∞–Ω–∞']} MP", 
                 delta=None, help="–ë–∞–∑–æ–≤—ã–π –∑–∞–ø–∞—Å –º–∞–Ω—ã")
        
        # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–µ–∫—É—â–∏–π –≤–∏–Ω—Ä–µ–π—Ç –≥–µ—Ä–æ—è (–∏–∑ –≤–∫–ª–∞–¥–∫–∏ 1)
        winrates_tab1 = {hero: round(random.uniform(40, 60), 1) for hero in HEROES}
        current_winrate = winrates_tab1[hero]
        st.metric("–¢–µ–∫—É—â–∏–π –≤–∏–Ω—Ä–µ–π—Ç", f"{current_winrate}%", 
                 delta=None, help="–ê–∫—Ç—É–∞–ª—å–Ω—ã–π –≤–∏–Ω—Ä–µ–π—Ç –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏")
    
    with col2:
        st.write("**–ü—Ä–µ–¥–ª–∞–≥–∞–µ–º—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:**")
        
        # –°–ª–∞–π–¥–µ—Ä—ã —Å —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–º–∏ –¥–∏–∞–ø–∞–∑–æ–Ω–∞–º–∏
        proposed_params["–ó–¥–æ—Ä–æ–≤—å–µ"] = st.slider(
            "–ó–¥–æ—Ä–æ–≤—å–µ (HP)", 
            min_value=300, 
            max_value=1200, 
            value=current_params["–ó–¥–æ—Ä–æ–≤—å–µ"],
            step=10,
            key=f"slider_hp_{hero}",
            help="–ò–∑–º–µ–Ω–µ–Ω–∏–µ –±–∞–∑–æ–≤–æ–≥–æ –∑–¥–æ—Ä–æ–≤—å—è"
        )
        
        proposed_params["–ë—Ä–æ–Ω—è"] = st.slider(
            "–ë—Ä–æ–Ω—è", 
            min_value=-5.0, 
            max_value=20.0, 
            value=float(current_params["–ë—Ä–æ–Ω—è"]),
            step=0.5,
            key=f"slider_armor_{hero}",
            help="–ò–∑–º–µ–Ω–µ–Ω–∏–µ –±–∞–∑–æ–≤–æ–π –±—Ä–æ–Ω–∏"
        )
        
        proposed_params["–£—Ä–æ–Ω"] = st.slider(
            "–£—Ä–æ–Ω", 
            min_value=30, 
            max_value=200, 
            value=current_params["–£—Ä–æ–Ω"],
            step=5,
            key=f"slider_damage_{hero}",
            help="–ò–∑–º–µ–Ω–µ–Ω–∏–µ –±–∞–∑–æ–≤–æ–≥–æ —É—Ä–æ–Ω–∞"
        )
        
        proposed_params["–°–∫–æ—Ä–æ—Å—Ç—å –∞—Ç–∞–∫–∏"] = st.slider(
            "–°–∫–æ—Ä–æ—Å—Ç—å –∞—Ç–∞–∫–∏", 
            min_value=20, 
            max_value=300, 
            value=current_params["–°–∫–æ—Ä–æ—Å—Ç—å –∞—Ç–∞–∫–∏"],
            step=5,
            key=f"slider_attack_speed_{hero}",
            help="–ò–∑–º–µ–Ω–µ–Ω–∏–µ –±–∞–∑–æ–≤–æ–π —Å–∫–æ—Ä–æ—Å—Ç–∏ –∞—Ç–∞–∫–∏"
        )
        
        proposed_params["–ú–∞–Ω–∞"] = st.slider(
            "–ú–∞–Ω–∞ (MP)", 
            min_value=50, 
            max_value=500, 
            value=current_params["–ú–∞–Ω–∞"],
            step=10,
            key=f"slider_mana_{hero}",
            help="–ò–∑–º–µ–Ω–µ–Ω–∏–µ –±–∞–∑–æ–≤–æ–≥–æ –∑–∞–ø–∞—Å–∞ –º–∞–Ω—ã"
        )
    
    # –ö–Ω–æ–ø–∫–∞ –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞
    if st.button("–†–∞—Å—Å—á–∏—Ç–∞—Ç—å –≤–ª–∏—è–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π", type="primary", key="calculate_impact"):
        # –†–∞—Å—á–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö
        health_change_pct = ((proposed_params["–ó–¥–æ—Ä–æ–≤—å–µ"] / current_params["–ó–¥–æ—Ä–æ–≤—å–µ"]) - 1) * 100
        armor_change_abs = proposed_params["–ë—Ä–æ–Ω—è"] - current_params["–ë—Ä–æ–Ω—è"]
        damage_change_pct = ((proposed_params["–£—Ä–æ–Ω"] / current_params["–£—Ä–æ–Ω"]) - 1) * 100
        attack_speed_change_pct = ((proposed_params["–°–∫–æ—Ä–æ—Å—Ç—å –∞—Ç–∞–∫–∏"] / current_params["–°–∫–æ—Ä–æ—Å—Ç—å –∞—Ç–∞–∫–∏"]) - 1) * 100
        mana_change_pct = ((proposed_params["–ú–∞–Ω–∞"] / current_params["–ú–∞–Ω–∞"]) - 1) * 100
        
        # –í–µ—Å–∞ –≤–ª–∏—è–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –Ω–∞ –≤–∏–Ω—Ä–µ–π—Ç (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ä–æ–ª–∏ –≥–µ—Ä–æ—è)
        if hero == "Axe" or hero == "Pudge":
            # –¢–∞–Ω–∫–∏/–∏–Ω–∏—Ü–∏–∏–∞—Ç–æ—Ä—ã
            weights = {"–ó–¥–æ—Ä–æ–≤—å–µ": 0.35, "–ë—Ä–æ–Ω—è": 0.3, "–£—Ä–æ–Ω": 0.15, "–°–∫–æ—Ä–æ—Å—Ç—å –∞—Ç–∞–∫–∏": 0.1, "–ú–∞–Ω–∞": 0.1}
        elif hero == "–î–∂–∞–≥–≥–µ—Ä–Ω–∞—É—Ç":
            # –ö–µ—Ä—Ä–∏/—É—Ä–æ–Ω
            weights = {"–ó–¥–æ—Ä–æ–≤—å–µ": 0.2, "–ë—Ä–æ–Ω—è": 0.15, "–£—Ä–æ–Ω": 0.35, "–°–∫–æ—Ä–æ—Å—Ç—å –∞—Ç–∞–∫–∏": 0.2, "–ú–∞–Ω–∞": 0.1}
        elif hero == "Invoker" or hero == "Cristal maiden":
            # –ú–∞–≥–∏/—Å–∞–ø–ø–æ—Ä—Ç—ã
            weights = {"–ó–¥–æ—Ä–æ–≤—å–µ": 0.25, "–ë—Ä–æ–Ω—è": 0.2, "–£—Ä–æ–Ω": 0.1, "–°–∫–æ—Ä–æ—Å—Ç—å –∞—Ç–∞–∫–∏": 0.1, "–ú–∞–Ω–∞": 0.35}
        else:
            weights = {"–ó–¥–æ—Ä–æ–≤—å–µ": 0.25, "–ë—Ä–æ–Ω—è": 0.25, "–£—Ä–æ–Ω": 0.2, "–°–∫–æ—Ä–æ—Å—Ç—å –∞—Ç–∞–∫–∏": 0.2, "–ú–∞–Ω–∞": 0.1}
        
        # –†–∞—Å—á–µ—Ç –æ–±—â–µ–≥–æ –≤–ª–∏—è–Ω–∏—è –Ω–∞ –≤–∏–Ω—Ä–µ–π—Ç
        total_impact = (
            health_change_pct * weights["–ó–¥–æ—Ä–æ–≤—å–µ"] * 0.3 +  # –ó–¥–æ—Ä–æ–≤—å–µ –≤–ª–∏—è–µ—Ç —É–º–µ—Ä–µ–Ω–Ω–æ
            armor_change_abs * 10 * weights["–ë—Ä–æ–Ω—è"] * 0.25 +  # –ë—Ä–æ–Ω—è —Å–∏–ª—å–Ω–æ –≤–ª–∏—è–µ—Ç
            damage_change_pct * weights["–£—Ä–æ–Ω"] * 0.4 +  # –£—Ä–æ–Ω —Å–∏–ª—å–Ω–æ –≤–ª–∏—è–µ—Ç –Ω–∞ —É—Ä–æ–Ω-–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö
            attack_speed_change_pct * weights["–°–∫–æ—Ä–æ—Å—Ç—å –∞—Ç–∞–∫–∏"] * 0.35 +  # –°–∫–æ—Ä–æ—Å—Ç—å –∞—Ç–∞–∫–∏ —É–º–µ—Ä–µ–Ω–Ω–æ –≤–ª–∏—è–µ—Ç
            mana_change_pct * weights["–ú–∞–Ω–∞"] * 0.2  # –ú–∞–Ω–∞ —Å–ª–∞–±–æ –≤–ª–∏—è–µ—Ç –¥–ª—è –Ω–µ-–º–∞–≥–æ–≤
        )
        
        # –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –¥–∏–∞–ø–∞–∑–æ–Ω –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤–∏–Ω—Ä–µ–π—Ç–∞
        delta = max(-15, min(15, total_impact))
        new_winrate = max(30, min(70, current_winrate + delta))
        
        st.subheader("üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞ –±–∞–ª–∞–Ω—Å–∞")
        
        # –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è
        col_res1, col_res2, col_res3 = st.columns(3)
        
        with col_res1:
            st.metric("–¢–µ–∫—É—â–∏–π –≤–∏–Ω—Ä–µ–π—Ç", f"{current_winrate}%", 
                     delta=f"{delta:.1f}%", delta_color="inverse" if delta > 5 or delta < -5 else "normal")
            st.metric("–ü—Ä–æ–≥–Ω–æ–∑–∏—Ä—É–µ–º—ã–π –≤–∏–Ω—Ä–µ–π—Ç", f"{new_winrate:.1f}%")
        
        with col_res2:
            # –†–∞—Å—á–µ—Ç —Ä–∏—Å–∫–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–µ–ª–∏—á–∏–Ω—ã –∏–∑–º–µ–Ω–µ–Ω–∏–π
            max_change_pct = max(
                abs(health_change_pct),
                abs(damage_change_pct),
                abs(attack_speed_change_pct),
                abs(mana_change_pct),
                abs(armor_change_abs * 5)
            )
            
            if max_change_pct > 25:
                risk = "üî¥ –í—ã—Å–æ–∫–∏–π"
                risk_color = "red"
            elif max_change_pct > 15:
                risk = "üü° –°—Ä–µ–¥–Ω–∏–π"
                risk_color = "yellow"
            else:
                risk = "üü¢ –ù–∏–∑–∫–∏–π"
                risk_color = "green"
            
            st.metric("–£—Ä–æ–≤–µ–Ω—å —Ä–∏—Å–∫–∞ –±–∞–ª–∞–Ω—Å–∞", risk)
            
            # –°–ª–æ–∂–Ω–æ—Å—Ç—å –≤–Ω–µ–¥—Ä–µ–Ω–∏—è
            complexity = "–ü—Ä–æ—Å—Ç–∞—è" if max_change_pct < 10 else "–°—Ä–µ–¥–Ω—è—è" if max_change_pct < 20 else "–°–ª–æ–∂–Ω–∞—è"
            st.metric("–°–ª–æ–∂–Ω–æ—Å—Ç—å –≤–Ω–µ–¥—Ä–µ–Ω–∏—è", complexity)
        
        with col_res3:
            # –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏–π
            efficiency_score = abs(delta) / max(1, max_change_pct) * 10
            if efficiency_score > 0.8:
                efficiency = "–í—ã—Å–æ–∫–∞—è"
                eff_color = "green"
            elif efficiency_score > 0.4:
                efficiency = "–°—Ä–µ–¥–Ω—è—è"
                eff_color = "orange"
            else:
                efficiency = "–ù–∏–∑–∫–∞—è"
                eff_color = "red"
            
            st.metric("–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏–π", efficiency)
        
        # –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –≤–µ—Å–æ–≤ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –¥–ª—è —ç—Ç–æ–≥–æ –≥–µ—Ä–æ—è
        st.subheader("üìà –í–ª–∏—è–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –Ω–∞ –≤–∏–Ω—Ä–µ–π—Ç (–¥–ª—è –¥–∞–Ω–Ω–æ–≥–æ –≥–µ—Ä–æ—è)")
        df_importance = pd.DataFrame(list(weights.items()), 
                                     columns=["–ü–∞—Ä–∞–º–µ—Ç—Ä", "–í–µ—Å –≤–ª–∏—è–Ω–∏—è"])
        fig3 = px.bar(df_importance.sort_values(by="–í–µ—Å –≤–ª–∏—è–Ω–∏—è"), 
                     x="–í–µ—Å –≤–ª–∏—è–Ω–∏—è", y="–ü–∞—Ä–∞–º–µ—Ç—Ä", 
                     orientation='h', color="–í–µ—Å –≤–ª–∏—è–Ω–∏—è",
                     color_continuous_scale="Viridis")
        st.plotly_chart(fig3, use_container_width=True)
        
        # –î–µ—Ç–∞–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π
        st.subheader("üìã –î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π")
        changes_data = {
            "–ü–∞—Ä–∞–º–µ—Ç—Ä": ["–ó–¥–æ—Ä–æ–≤—å–µ (HP)", "–ë—Ä–æ–Ω—è", "–£—Ä–æ–Ω", "–°–∫–æ—Ä–æ—Å—Ç—å –∞—Ç–∞–∫–∏", "–ú–∞–Ω–∞ (MP)"],
            "–¢–µ–∫—É—â–µ–µ": [
                f"{current_params['–ó–¥–æ—Ä–æ–≤—å–µ']}",
                f"{current_params['–ë—Ä–æ–Ω—è']}",
                f"{current_params['–£—Ä–æ–Ω']}",
                f"{current_params['–°–∫–æ—Ä–æ—Å—Ç—å –∞—Ç–∞–∫–∏']}",
                f"{current_params['–ú–∞–Ω–∞']}"
            ],
            "–ù–æ–≤–æ–µ": [
                f"{proposed_params['–ó–¥–æ—Ä–æ–≤—å–µ']}",
                f"{proposed_params['–ë—Ä–æ–Ω—è']:.1f}",
                f"{proposed_params['–£—Ä–æ–Ω']}",
                f"{proposed_params['–°–∫–æ—Ä–æ—Å—Ç—å –∞—Ç–∞–∫–∏']}",
                f"{proposed_params['–ú–∞–Ω–∞']}"
            ],
            "–ê–±—Å. –∏–∑–º–µ–Ω–µ–Ω–∏–µ": [
                f"{proposed_params['–ó–¥–æ—Ä–æ–≤—å–µ'] - current_params['–ó–¥–æ—Ä–æ–≤—å–µ']:+.0f}",
                f"{proposed_params['–ë—Ä–æ–Ω—è'] - current_params['–ë—Ä–æ–Ω—è']:+.1f}",
                f"{proposed_params['–£—Ä–æ–Ω'] - current_params['–£—Ä–æ–Ω']:+.0f}",
                f"{proposed_params['–°–∫–æ—Ä–æ—Å—Ç—å –∞—Ç–∞–∫–∏'] - current_params['–°–∫–æ—Ä–æ—Å—Ç—å –∞—Ç–∞–∫–∏']:+.0f}",
                f"{proposed_params['–ú–∞–Ω–∞'] - current_params['–ú–∞–Ω–∞']:+.0f}"
            ],
            "% –∏–∑–º–µ–Ω–µ–Ω–∏–µ": [
                f"{health_change_pct:+.1f}%" if current_params['–ó–¥–æ—Ä–æ–≤—å–µ'] > 0 else "0%",
                f"{(armor_change_abs/current_params['–ë—Ä–æ–Ω—è'])*100 if current_params['–ë—Ä–æ–Ω—è'] != 0 else '‚àû':+.1f}%",
                f"{damage_change_pct:+.1f}%" if current_params['–£—Ä–æ–Ω'] > 0 else "0%",
                f"{attack_speed_change_pct:+.1f}%" if current_params['–°–∫–æ—Ä–æ—Å—Ç—å –∞—Ç–∞–∫–∏'] > 0 else "0%",
                f"{mana_change_pct:+.1f}%" if current_params['–ú–∞–Ω–∞'] > 0 else "0%"
            ]
        }
        
        # –°–æ–∑–¥–∞–µ–º —Ç–∞–±–ª–∏—Ü—É —Å —Ü–≤–µ—Ç–æ–≤—ã–º –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ–º
        df_changes = pd.DataFrame(changes_data)
        st.dataframe(df_changes, use_container_width=True, hide_index=True)
        
        # –ì—Ä–∞—Ñ–∏–∫ –∏–∑–º–µ–Ω–µ–Ω–∏–π –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
        st.subheader("üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö –∏ –Ω–æ–≤—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤")
        
        # –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–∞
        params_names = list(current_params.keys())
        old_values = list(current_params.values())
        new_values = list(proposed_params.values())
        
        fig_comparison = go.Figure(data=[
            go.Bar(name='–¢–µ–∫—É—â–∏–µ', x=params_names, y=old_values, marker_color='lightblue'),
            go.Bar(name='–ü—Ä–µ–¥–ª–∞–≥–∞–µ–º—ã–µ', x=params_names, y=new_values, marker_color='lightgreen')
        ])
        
        fig_comparison.update_layout(
            barmode='group',
            title=f"–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≥–µ—Ä–æ—è {hero}",
            xaxis_title="–ü–∞—Ä–∞–º–µ—Ç—Ä—ã",
            yaxis_title="–ó–Ω–∞—á–µ–Ω–∏–µ",
            showlegend=True
        )
        
        st.plotly_chart(fig_comparison, use_container_width=True)
        
        # –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–µ
        st.subheader("üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–µ")
        
        if delta > 8:
            st.error("### ‚ö†Ô∏è **–í–´–°–û–ö–ò–ô –†–ò–°–ö –î–ò–°–ë–ê–õ–ê–ù–°–ê**")
            st.markdown(f"""
            –ì–µ—Ä–æ–π **{hero}** —Å—Ç–∞–Ω–µ—Ç —Å–ª–∏—à–∫–æ–º —Å–∏–ª—å–Ω—ã–º (+{delta:.1f}% –∫ –≤–∏–Ω—Ä–µ–π—Ç—É).
            
            **–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏:**
            1. –£–º–µ–Ω—å—à–∏—Ç–µ —É—Ä–æ–Ω –Ω–∞ 10-15%
            2. –°–Ω–∏–∑—å—Ç–µ —Å–∫–æ—Ä–æ—Å—Ç—å –∞—Ç–∞–∫–∏ –Ω–∞ 10-20%
            3. –£–≤–µ–ª–∏—á—å—Ç–µ —Å—Ç–æ–∏–º–æ—Å—Ç—å —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–µ–π –Ω–∞ 20-30%
            4. –†–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ —É–º–µ–Ω—å—à–µ–Ω–∏–µ –∑–¥–æ—Ä–æ–≤—å—è –Ω–∞ 5-10%
            """)
        elif delta > 4:
            st.warning("### ‚ö†Ô∏è **–£–ú–ï–†–ï–ù–ù–´–ô –†–ò–°–ö –£–°–ò–õ–ï–ù–ò–Ø**")
            st.markdown(f"""
            –ì–µ—Ä–æ–π **{hero}** –º–æ–∂–µ—Ç —Å—Ç–∞—Ç—å —Å–∏–ª—å–Ω–µ–µ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ (+{delta:.1f}% –∫ –≤–∏–Ω—Ä–µ–π—Ç—É).
            
            **–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏:**
            1. –ù–µ–±–æ–ª—å—à–æ–µ —É–º–µ–Ω—å—à–µ–Ω–∏–µ –±—Ä–æ–Ω–∏ –∏–ª–∏ –∑–¥–æ—Ä–æ–≤—å—è
            2. –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ —á–µ—Ä–µ–∑ —Å—Ç–æ–∏–º–æ—Å—Ç—å –ø—Ä–µ–¥–º–µ—Ç–æ–≤
            3. –£–≤–µ–ª–∏—á–µ–Ω–∏–µ –∑–∞–¥–µ—Ä–∂–∫–∏ (cooldown) –Ω–∞ –∫–ª—é—á–µ–≤—ã–µ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏
            """)
        elif delta < -8:
            st.error("### ‚ö†Ô∏è **–í–´–°–û–ö–ò–ô –†–ò–°–ö –û–°–õ–ê–ë–õ–ï–ù–ò–Ø**")
            st.markdown(f"""
            –ì–µ—Ä–æ–π **{hero}** —Å—Ç–∞–Ω–µ—Ç —Å–ª–∏—à–∫–æ–º —Å–ª–∞–±—ã–º ({delta:.1f}% –∫ –≤–∏–Ω—Ä–µ–π—Ç—É).
            
            **–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏:**
            1. –£–≤–µ–ª–∏—á—å—Ç–µ –±–∞–∑–æ–≤–æ–µ –∑–¥–æ—Ä–æ–≤—å–µ –Ω–∞ 15-20%
            2. –î–æ–±–∞–≤—å—Ç–µ –ø–∞—Å—Å–∏–≤–Ω—É—é —Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏—é –º–∞–Ω—ã/–∑–¥–æ—Ä–æ–≤—å—è
            3. –£–º–µ–Ω—å—à–∏—Ç–µ —Å—Ç–æ–∏–º–æ—Å—Ç—å —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–µ–π –Ω–∞ 20-30%
            4. –£–≤–µ–ª–∏—á—å—Ç–µ –±–∞–∑–æ–≤—ã–π —É—Ä–æ–Ω –Ω–∞ 10-15%
            """)
        elif delta < -4:
            st.warning("### ‚ö†Ô∏è **–£–ú–ï–†–ï–ù–ù–´–ô –†–ò–°–ö –û–°–õ–ê–ë–õ–ï–ù–ò–Ø**")
            st.markdown(f"""
            –ì–µ—Ä–æ–π **{hero}** –º–æ–∂–µ—Ç —Å—Ç–∞—Ç—å —Å–ª–∞–±–µ–µ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ ({delta:.1f}% –∫ –≤–∏–Ω—Ä–µ–π—Ç—É).
            
            **–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏:**
            1. –£–≤–µ–ª–∏—á–µ–Ω–∏–µ —É—Ä–æ–Ω–∞ –Ω–∞ 5-10%
            2. –£–ª—É—á—à–µ–Ω–∏–µ –±–∞–∑–æ–≤—ã—Ö —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫
            3. –£–º–µ–Ω—å—à–µ–Ω–∏–µ –∑–∞–¥–µ—Ä–∂–∫–∏ (cooldown) –Ω–∞ –≤—Ç–æ—Ä–æ—Å—Ç–µ–ø–µ–Ω–Ω—ã–µ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏
            """)
        else:
            st.success("### ‚úÖ **–ë–ï–ó–û–ü–ê–°–ù–´–ô –î–ò–ê–ü–ê–ó–û–ù**")
            st.markdown(f"""
            –ü—Ä–µ–¥–ª–∞–≥–∞–µ–º—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ–º –¥–∏–∞–ø–∞–∑–æ–Ω–µ (¬±{abs(delta):.1f}% –∫ –≤–∏–Ω—Ä–µ–π—Ç—É).
            
            **–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:**
            1. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–º —Å–µ—Ä–≤–µ—Ä–µ
            2. –°–æ–±—Ä–∞—Ç—å –æ—Ç–∑—ã–≤—ã –æ—Ç –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã—Ö –∏–≥—Ä–æ–∫–æ–≤
            3. –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –≤ —Ç–µ—á–µ–Ω–∏–µ 2-4 –Ω–µ–¥–µ–ª—å
            4. –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –≤–Ω–µ—Å—Ç–∏ –º–∏–∫—Ä–æ-–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏
            """)
        
        # –ö–Ω–æ–ø–∫–∞ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫
        if st.button("üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è", key="save_changes"):
            st.session_state[f'proposed_changes_{hero}'] = proposed_params
            st.session_state[f'calculated_winrate_{hero}'] = new_winrate
            st.success(f"–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –≥–µ—Ä–æ—è {hero} —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã!")
            
            # –ü–æ–∫–∞–∑–∞—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
            with st.expander("–ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏"):
                st.write(f"**–ì–µ—Ä–æ–π:** {hero}")
                st.write(f"**–ü—Ä–æ–≥–Ω–æ–∑–∏—Ä—É–µ–º—ã–π –≤–∏–Ω—Ä–µ–π—Ç:** {new_winrate:.1f}%")
                st.write("**–°–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**")
                st.json(proposed_params)


# =================== –í–ö–õ–ê–î–ö–ê 3: –ì–ï–ù–ï–†–ê–¢–û–† –ö–û–ù–¢–ï–ù–¢–ê ===================
with tab3:
    st.header("–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –∏–≥—Ä–æ–≤–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞")
    
    item_type = st.selectbox("–¢–∏–ø –ø—Ä–µ–¥–º–µ—Ç–∞:", ["–û—Ä—É–∂–∏–µ", "–ë—Ä–æ–Ω—è", "–ê—Ä—Ç–µ—Ñ–∞–∫—Ç", "–ó–µ–ª—å–µ"])
    style = st.selectbox("–°—Ç–∏–ª—å –æ–ø–∏—Å–∞–Ω–∏—è:", ["–§—ç–Ω—Ç–µ–∑–∏", "–ö–∏–±–µ—Ä–ø–∞–Ω–∫", "–ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–π", "–ú–∏—Å—Ç–∏—á–µ—Å–∫–∏–π"])
    
    if st.button("–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–µ–¥–º–µ—Ç", type="primary"):
        st.subheader("üéâ –ù–æ–≤—ã–π –ø—Ä–µ–¥–º–µ—Ç —Å–æ–∑–¥–∞–Ω!")
        
        # –î–µ–º–æ-—Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏
        characteristics = {
            "–£—Ä–æ–Ω": random.randint(10, 100),
            "–ó–∞—â–∏—Ç–∞": random.randint(5, 50),
            "–†–µ–¥–∫–æ—Å—Ç—å": random.choice(["–û–±—ã—á–Ω—ã–π", "–†–µ–¥–∫–∏–π", "–≠–ø–∏—á–µ—Å–∫–∏–π", "–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π"]),
            "–°—Ç–æ–∏–º–æ—Å—Ç—å": random.randint(100, 1000)
        }
        
        # –î–µ–º–æ-–æ–ø–∏—Å–∞–Ω–∏–µ
        descriptions = {
            "–§—ç–Ω—Ç–µ–∑–∏": f"–î—Ä–µ–≤–Ω–∏–π {item_type.lower()}, –∏—Å–ø–µ—â—Ä—ë–Ω–Ω—ã–π —Ä—É–Ω–∞–º–∏ —ç–ª—å—Ñ–æ–≤. –ò–∑–ª—É—á–∞–µ—Ç –º—è–≥–∫–æ–µ —Å–≤–µ—á–µ–Ω–∏–µ.",
            "–ö–∏–±–µ—Ä–ø–∞–Ω–∫": f"–í—ã—Å–æ–∫–æ—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—á–Ω—ã–π {item_type.lower()} —Å –≥–æ–ª–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º. –ü–∏–∫—Å–µ–ª–∏ –º–µ—Ä—Ü–∞—é—Ç –Ω–µ–æ–Ω–æ–≤—ã–º —Å–≤–µ—Ç–æ–º.",
            "–ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–π": f"–ê—É—Ç–µ–Ω—Ç–∏—á–Ω—ã–π {item_type.lower()} —ç–ø–æ—Ö–∏ –≤–æ–∑—Ä–æ–∂–¥–µ–Ω–∏—è. –°–ª–µ–¥—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≥–æ–≤–æ—Ä—è—Ç –æ –º–Ω–æ–≥–∏—Ö –±–∏—Ç–≤–∞—Ö.",
            "–ú–∏—Å—Ç–∏—á–µ—Å–∫–∏–π": f"{item_type.capitalize()}, —Ö—Ä–∞–Ω—è—â–∏–π —Ç–∞–π–Ω—ã –¥—Ä–µ–≤–Ω–∏—Ö –∫—É–ª—å—Ç–æ–≤. –ü—Ä–∏ –∫–∞—Å–∞–Ω–∏–∏ —Å–ª—ã—à–µ–Ω —à—ë–ø–æ—Ç —Ç–µ–Ω–µ–π."
        }
        
        col1, col2 = st.columns(2)
        
        with col1:
            st.subheader("–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏")
            for key, value in characteristics.items():
                st.metric(key, value)
            
            # –û—Ü–µ–Ω–∫–∞ –±–∞–ª–∞–Ω—Å–∞
            balance_score = random.random()
            if balance_score > 0.7:
                st.success("‚úÖ –°–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω")
            elif balance_score > 0.4:
                st.warning("‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç –¥–æ—Ä–∞–±–æ—Ç–∫–∏")
            else:
                st.error("‚ùå –î–∏—Å–±–∞–ª–∞–Ω—Å")
        
        with col2:
            st.subheader("–û–ø–∏—Å–∞–Ω–∏–µ")
            st.info(descriptions[style])
            
            if style == "–ö–∏–±–µ—Ä–ø–∞–Ω–∫" and item_type == "–û—Ä—É–∂–∏–µ":
                st.warning("‚ö†Ô∏è –û–ø–∏—Å–∞–Ω–∏–µ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å—Ç–∏–ª—é –ö–∏–±–µ—Ä–ø–∞–Ω–∫ –¥–ª—è –æ—Ä—É–∂–∏—è. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ø–µ—Ä–µ–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å.")
                if st.button("–ü–µ—Ä–µ–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –æ–ø–∏—Å–∞–Ω–∏–µ"):
                    st.rerun()

# =================== –í–ö–õ–ê–î–ö–ê 4: –ó–ê–ì–†–£–ó–ö–ê –î–ê–ù–ù–´–• ===================
with tab4:
    st.header("–ó–∞–≥—Ä—É–∑–∫–∞ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö")
    
    data_source = st.radio("–ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö:", ["OpenDota API", "–õ–æ–∫–∞–ª—å–Ω—ã–π —Ñ–∞–π–ª", "–î–µ–º–æ-–¥–∞–Ω–Ω—ã–µ"])
    
    if data_source == "OpenDota API":
        matches_limit = st.number_input("–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–∞—Ç—á–µ–π:", min_value=10, max_value=10000, value=100)
        if st.button("–ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ —Å OpenDota"):
            with st.spinner("–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö..."):
                # –ò–º–∏—Ç–∞—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏
                import time
                time.sleep(2)
                st.success(f"‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ {matches_limit} –º–∞—Ç—á–µ–π")
    
    elif data_source == "–õ–æ–∫–∞–ª—å–Ω—ã–π —Ñ–∞–π–ª":
        uploaded_file = st.file_uploader("–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª (JSON, CSV)", type=["json", "csv"])
        if uploaded_file:
            st.success(f"‚úÖ –§–∞–π–ª {uploaded_file.name} –∑–∞–≥—Ä—É–∂–µ–Ω")
    
    else:
        st.info("–ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –¥–µ–º–æ-–¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.")
    
    if st.button("–ó–∞–ø—É—Å—Ç–∏—Ç—å ETL-–ø–∞–π–ø–ª–∞–π–Ω", type="primary"):
        progress_bar = st.progress(0)
        for i in range(100):
            # –ò–º–∏—Ç–∞—Ü–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞
            import time
            time.sleep(0.02)
            progress_bar.progress(i + 1)
        st.success("‚úÖ –î–∞–Ω–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã –∏ –≥–æ—Ç–æ–≤—ã –∫ –∞–Ω–∞–ª–∏–∑—É")

# =================== –§–£–¢–ï–† ===================
st.markdown("---")
st.caption("–ü—Ä–æ—Ç–æ—Ç–∏–ø –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –±–∞–ª–∞–Ω—Å–∞ –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–≥—Ä–æ–≤–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ | 2024")
