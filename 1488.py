import streamlit as st
import pandas as pd
import plotly.express as px
import plotly.graph_objects as go
import random

# =================== –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø ===================
st.set_page_config(page_title="Game Balance AI", layout="wide")

# –î–µ–º–æ-–¥–∞–Ω–Ω—ã–µ
HEROES = ["Axe", "–î–∂–∞–≥–≥–µ—Ä–Ω–∞—É—Ç", "Invoker", "Cristal maiden", "Pudge"]
PARAMS = ["–£—Ä–æ–Ω", "–ó–¥–æ—Ä–æ–≤—å–µ", "–°–∫–æ—Ä–æ—Å—Ç—å –∞—Ç–∞–∫–∏", "–ë—Ä–æ–Ω—è", "–ú–∞–Ω–∞"]

# =================== –ó–ê–ì–û–õ–û–í–û–ö ===================
st.title("üéÆ –ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∞–Ω–∞–ª–∏–∑–∞ –±–∞–ª–∞–Ω—Å–∞ –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞")
st.markdown("---")

# =================== –í–ö–õ–ê–î–ö–ò ===================
tab1, tab2, tab3, tab4 = st.tabs(["–î–∞—à–±–æ—Ä–¥", "–ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞", "–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –∫–æ–Ω—Ç–µ–Ω—Ç–∞", "–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö"])

# =================== –í–ö–õ–ê–î–ö–ê 1: –î–ê–®–ë–û–†–î ===================
with tab1:
    st.header("–û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±–∞–ª–∞–Ω—Å–∞")
    
    # –î–µ–º–æ-–¥–∞–Ω–Ω—ã–µ –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–æ–≤
    winrates = {hero: round(random.uniform(40, 60), 1) for hero in HEROES}
    pickrates = {hero: random.randint(5, 30) for hero in HEROES}
    
    df_winrate = pd.DataFrame(list(winrates.items()), columns=["–ì–µ—Ä–æ–π", "–í–∏–Ω—Ä–µ–π—Ç (%)"])
    df_pickrate = pd.DataFrame(list(pickrates.items()), columns=["–ì–µ—Ä–æ–π", "–ß–∞—Å—Ç–æ—Ç–∞ –≤—ã–±–æ—Ä–∞ (%)"])
    
    col1, col2 = st.columns(2)
    
    with col1:
        st.subheader("–¢–æ–ø-5 –≥–µ—Ä–æ–µ–≤ –ø–æ –≤–∏–Ω—Ä–µ–π—Ç—É")
        fig1 = px.bar(df_winrate.sort_values(by="–í–∏–Ω—Ä–µ–π—Ç (%)", ascending=False), 
                      x="–ì–µ—Ä–æ–π", y="–í–∏–Ω—Ä–µ–π—Ç (%)", color="–í–∏–Ω—Ä–µ–π—Ç (%)")
        st.plotly_chart(fig1, use_container_width=True)
    
    with col2:
        st.subheader("–ü–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç—å –≥–µ—Ä–æ–µ–≤")
        fig2 = px.pie(df_pickrate, names="–ì–µ—Ä–æ–π", values="–ß–∞—Å—Ç–æ—Ç–∞ –≤—ã–±–æ—Ä–∞ (%)")
        st.plotly_chart(fig2, use_container_width=True)
    
    st.subheader("–û—Ç—á—ë—Ç –æ –¥–∏—Å–±–∞–ª–∞–Ω—Å–µ")
    imbalance_report = {
        "–ì–µ—Ä–æ–π": ["–ê–∫—Å", "–î–∂–∞–≥–≥–µ—Ä–Ω–∞—É—Ç", "–ò–Ω–≤–æ–∫–µ—Ä"],
        "–ü—Ä–æ–±–ª–µ–º–∞": ["–°–ª–∏—à–∫–æ–º –≤—ã—Å–æ–∫–∏–π –≤–∏–Ω—Ä–µ–π—Ç", "–ù–∏–∑–∫–∞—è –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç—å", "–°–∏–ª—å–Ω–∞—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç –º–∞–Ω—ã"],
        "–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è": ["–£–º–µ–Ω—å—à–∏—Ç—å —É—Ä–æ–Ω –Ω–∞ 5%", "–£–≤–µ–ª–∏—á–∏—Ç—å –±–∞–∑–æ–≤–æ–µ –∑–¥–æ—Ä–æ–≤—å–µ", "–£–º–µ–Ω—å—à–∏—Ç—å —Å—Ç–æ–∏–º–æ—Å—Ç—å —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–µ–π"]
    }
    st.table(pd.DataFrame(imbalance_report))

# =================== –í–ö–õ–ê–î–ö–ê 2: –ë–ê–õ–ê–ù–°–ò–†–û–í–ö–ê ===================
with tab2:
    st.header("What-if –∞–Ω–∞–ª–∏–∑ –±–∞–ª–∞–Ω—Å–∞")
    
    hero = st.selectbox("–í—ã–±–µ—Ä–∏—Ç–µ –≥–µ—Ä–æ—è:", HEROES, key="balance_hero")
    
    st.subheader("–¢–µ–∫—É—â–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã")
    
    # –†–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–µ —Å—Ç–∞—Ä—Ç–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è –≥–µ—Ä–æ—è
    current_params = {
        "–ó–¥–æ—Ä–æ–≤—å–µ": random.randint(600, 800),
        "–ë—Ä–æ–Ω—è": round(random.uniform(0, 5), 1),
        "–£—Ä–æ–Ω": random.randint(50, 100),
        "–°–∫–æ—Ä–æ—Å—Ç—å –∞—Ç–∞–∫–∏": random.randint(50, 150),
        "–ú–∞–Ω–∞": random.randint(100, 300)
    }
    
    col1, col2 = st.columns(2)
    proposed_params = {}
    
    with col1:
        st.write("**–¢–µ–∫—É—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è:**")
        # –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º–∏ –µ–¥–∏–Ω–∏—Ü–∞–º–∏ –∏–∑–º–µ—Ä–µ–Ω–∏—è
        st.metric("–ó–¥–æ—Ä–æ–≤—å–µ", f"{current_params['–ó–¥–æ—Ä–æ–≤—å–µ']} HP")
        st.metric("–ë—Ä–æ–Ω—è", f"{current_params['–ë—Ä–æ–Ω—è']}")
        st.metric("–£—Ä–æ–Ω", f"{current_params['–£—Ä–æ–Ω']}")
        st.metric("–°–∫–æ—Ä–æ—Å—Ç—å –∞—Ç–∞–∫–∏", f"{current_params['–°–∫–æ—Ä–æ—Å—Ç—å –∞—Ç–∞–∫–∏']}")
        st.metric("–ú–∞–Ω–∞", f"{current_params['–ú–∞–Ω–∞']} MP")
    
    with col2:
        st.write("**–ü—Ä–µ–¥–ª–∞–≥–∞–µ–º—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:**")
        
        # –°–ª–∞–π–¥–µ—Ä—ã —Å —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–º–∏ –¥–∏–∞–ø–∞–∑–æ–Ω–∞–º–∏
        proposed_params["–ó–¥–æ—Ä–æ–≤—å–µ"] = st.slider(
            "–ó–¥–æ—Ä–æ–≤—å–µ (HP)", 
            min_value=300, 
            max_value=1200, 
            value=current_params["–ó–¥–æ—Ä–æ–≤—å–µ"],
            step=10,
            key="slider_hp"
        )
        
        proposed_params["–ë—Ä–æ–Ω—è"] = st.slider(
            "–ë—Ä–æ–Ω—è", 
            min_value=-5.0, 
            max_value=20.0, 
            value=float(current_params["–ë—Ä–æ–Ω—è"]),
            step=0.5,
            key="slider_armor"
        )
        
        proposed_params["–£—Ä–æ–Ω"] = st.slider(
            "–£—Ä–æ–Ω", 
            min_value=30, 
            max_value=200, 
            value=current_params["–£—Ä–æ–Ω"],
            step=5,
            key="slider_damage"
        )
        
        proposed_params["–°–∫–æ—Ä–æ—Å—Ç—å –∞—Ç–∞–∫–∏"] = st.slider(
            "–°–∫–æ—Ä–æ—Å—Ç—å –∞—Ç–∞–∫–∏", 
            min_value=20, 
            max_value=300, 
            value=current_params["–°–∫–æ—Ä–æ—Å—Ç—å –∞—Ç–∞–∫–∏"],
            step=5,
            key="slider_attack_speed"
        )
        
        proposed_params["–ú–∞–Ω–∞"] = st.slider(
            "–ú–∞–Ω–∞ (MP)", 
            min_value=50, 
            max_value=500, 
            value=current_params["–ú–∞–Ω–∞"],
            step=10,
            key="slider_mana"
        )
    
    if st.button("–†–∞—Å—Å—á–∏—Ç–∞—Ç—å –≤–ª–∏—è–Ω–∏–µ", type="primary"):
        # –†–∞—Å—á–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π
        health_change = ((proposed_params["–ó–¥–æ—Ä–æ–≤—å–µ"] / current_params["–ó–¥–æ—Ä–æ–≤—å–µ"]) - 1) * 100
        armor_change = (proposed_params["–ë—Ä–æ–Ω—è"] - current_params["–ë—Ä–æ–Ω—è"]) * 2  # –ë—Ä–æ–Ω—è —Å–∏–ª—å–Ω–æ –≤–ª–∏—è–µ—Ç
        damage_change = ((proposed_params["–£—Ä–æ–Ω"] / current_params["–£—Ä–æ–Ω"]) - 1) * 150
        attack_speed_change = ((proposed_params["–°–∫–æ—Ä–æ—Å—Ç—å –∞—Ç–∞–∫–∏"] / current_params["–°–∫–æ—Ä–æ—Å—Ç—å –∞—Ç–∞–∫–∏"]) - 1) * 100
        mana_change = ((proposed_params["–ú–∞–Ω–∞"] / current_params["–ú–∞–Ω–∞"]) - 1) * 50
        
        # –û–±—â–µ–µ –≤–ª–∏—è–Ω–∏–µ –Ω–∞ –≤–∏–Ω—Ä–µ–π—Ç (–¥–µ–º–æ-—Ä–∞—Å—á–µ—Ç)
        total_impact = (
            health_change * 0.3 +  # –ó–¥–æ—Ä–æ–≤—å–µ –≤–ª–∏—è–µ—Ç –Ω–∞ 30%
            armor_change * 0.25 +  # –ë—Ä–æ–Ω—è –≤–ª–∏—è–µ—Ç –Ω–∞ 25%
            damage_change * 0.2 +  # –£—Ä–æ–Ω –≤–ª–∏—è–µ—Ç –Ω–∞ 20%
            attack_speed_change * 0.15 +  # –°–∫–æ—Ä–æ—Å—Ç—å –∞—Ç–∞–∫–∏ –Ω–∞ 15%
            mana_change * 0.1  # –ú–∞–Ω–∞ –Ω–∞ 10%
        ) / 100
        
        # –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –¥–∏–∞–ø–∞–∑–æ–Ω –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤–∏–Ω—Ä–µ–π—Ç–∞
        delta = max(-15, min(15, total_impact))
        
        st.subheader("–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞")
        
        # –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è
        col_res1, col_res2, col_res3 = st.columns(3)
        
        with col_res1:
            st.metric("–ü—Ä–æ–≥–Ω–æ–∑–∏—Ä—É–µ–º–æ–µ ŒîWR", f"{delta:.1f}%", 
                      delta_color="inverse" if abs(delta) > 5 else "normal")
        
        with col_res2:
            # –†–∞—Å—á–µ—Ç —Ä–∏—Å–∫–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–µ–ª–∏—á–∏–Ω—ã –∏–∑–º–µ–Ω–µ–Ω–∏–π
            changes = [
                abs(proposed_params["–ó–¥–æ—Ä–æ–≤—å–µ"] - current_params["–ó–¥–æ—Ä–æ–≤—å–µ"]) / current_params["–ó–¥–æ—Ä–æ–≤—å–µ"],
                abs(proposed_params["–£—Ä–æ–Ω"] - current_params["–£—Ä–æ–Ω"]) / current_params["–£—Ä–æ–Ω"],
                abs(proposed_params["–ë—Ä–æ–Ω—è"] - current_params["–ë—Ä–æ–Ω—è"]) / (current_params["–ë—Ä–æ–Ω—è"] + 1)
            ]
            avg_change = sum(changes) / len(changes) * 100
            
            if avg_change > 30:
                risk = "üî¥ –í—ã—Å–æ–∫–∏–π"
            elif avg_change > 15:
                risk = "üü° –°—Ä–µ–¥–Ω–∏–π"
            else:
                risk = "üü¢ –ù–∏–∑–∫–∏–π"
            st.metric("–£—Ä–æ–≤–µ–Ω—å —Ä–∏—Å–∫–∞", risk)
        
        with col_res3:
            # –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏–π
            efficiency = "–í—ã—Å–æ–∫–∞—è" if abs(delta) > abs(avg_change/10) else "–°—Ä–µ–¥–Ω—è—è"
            st.metric("–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å", efficiency)
        
        # –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –≤–ª–∏—è–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
        importance = {
            "–ó–¥–æ—Ä–æ–≤—å–µ": 0.3,
            "–ë—Ä–æ–Ω—è": 0.25,
            "–£—Ä–æ–Ω": 0.2,
            "–°–∫–æ—Ä–æ—Å—Ç—å –∞—Ç–∞–∫–∏": 0.15,
            "–ú–∞–Ω–∞": 0.1
        }
        
        df_importance = pd.DataFrame(list(importance.items()), 
                                     columns=["–ü–∞—Ä–∞–º–µ—Ç—Ä", "–í–ª–∏—è–Ω–∏–µ –Ω–∞ –±–∞–ª–∞–Ω—Å"])
        fig3 = px.bar(df_importance.sort_values(by="–í–ª–∏—è–Ω–∏–µ –Ω–∞ –±–∞–ª–∞–Ω—Å"), 
                     x="–í–ª–∏—è–Ω–∏–µ –Ω–∞ –±–∞–ª–∞–Ω—Å", y="–ü–∞—Ä–∞–º–µ—Ç—Ä", 
                     orientation='h', color="–í–ª–∏—è–Ω–∏–µ –Ω–∞ –±–∞–ª–∞–Ω—Å")
        st.plotly_chart(fig3, use_container_width=True)
        
        # –¢–∞–±–ª–∏—Ü–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π
        st.subheader("–°–≤–æ–¥–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π")
        changes_data = {
            "–ü–∞—Ä–∞–º–µ—Ç—Ä": list(current_params.keys()),
            "–¢–µ–∫—É—â–µ–µ": list(current_params.values()),
            "–ù–æ–≤–æ–µ": list(proposed_params.values()),
            "–ò–∑–º–µ–Ω–µ–Ω–∏–µ (%)": [
                f"{((proposed_params['–ó–¥–æ—Ä–æ–≤—å–µ']/current_params['–ó–¥–æ—Ä–æ–≤—å–µ'])-1)*100:.1f}%" if current_params['–ó–¥–æ—Ä–æ–≤—å–µ'] > 0 else "0%",
                f"{proposed_params['–ë—Ä–æ–Ω—è'] - current_params['–ë—Ä–æ–Ω—è']:+.1f}",
                f"{((proposed_params['–£—Ä–æ–Ω']/current_params['–£—Ä–æ–Ω'])-1)*100:.1f}%" if current_params['–£—Ä–æ–Ω'] > 0 else "0%",
                f"{((proposed_params['–°–∫–æ—Ä–æ—Å—Ç—å –∞—Ç–∞–∫–∏']/current_params['–°–∫–æ—Ä–æ—Å—Ç—å –∞—Ç–∞–∫–∏'])-1)*100:.1f}%" if current_params['–°–∫–æ—Ä–æ—Å—Ç—å –∞—Ç–∞–∫–∏'] > 0 else "0%",
                f"{((proposed_params['–ú–∞–Ω–∞']/current_params['–ú–∞–Ω–∞'])-1)*100:.1f}%" if current_params['–ú–∞–Ω–∞'] > 0 else "0%"
            ]
        }
        st.table(pd.DataFrame(changes_data))
        
        # –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è
        if delta > 8:
            st.error("‚ö†Ô∏è **–û–ø–∞—Å–Ω–æ—Å—Ç—å:** –ì–µ—Ä–æ–π —Å—Ç–∞–Ω–µ—Ç —Å–ª–∏—à–∫–æ–º —Å–∏–ª—å–Ω—ã–º! –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:")
            st.markdown("""
            - –£–º–µ–Ω—å—à–∏—Ç—å —É—Ä–æ–Ω –Ω–∞ 10-15%
            - –°–Ω–∏–∑–∏—Ç—å —Å–∫–æ—Ä–æ—Å—Ç—å –∞—Ç–∞–∫–∏
            - –£–≤–µ–ª–∏—á–∏—Ç—å —Å—Ç–æ–∏–º–æ—Å—Ç—å —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–µ–π
            """)
        elif delta > 4:
            st.warning("‚ö†Ô∏è **–í–Ω–∏–º–∞–Ω–∏–µ:** –ì–µ—Ä–æ–π –º–æ–∂–µ—Ç —Å—Ç–∞—Ç—å —Å–∏–ª—å–Ω–µ–µ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ. –†–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ:")
            st.markdown("""
            - –ù–µ–±–æ–ª—å—à–æ–µ —É–º–µ–Ω—å—à–µ–Ω–∏–µ –∑–¥–æ—Ä–æ–≤—å—è –∏–ª–∏ –±—Ä–æ–Ω–∏
            - –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫—É —á–µ—Ä–µ–∑ —Å—Ç–æ–∏–º–æ—Å—Ç—å –ø—Ä–µ–¥–º–µ—Ç–æ–≤
            """)
        elif delta < -8:
            st.error("‚ö†Ô∏è **–û–ø–∞—Å–Ω–æ—Å—Ç—å:** –ì–µ—Ä–æ–π —Å—Ç–∞–Ω–µ—Ç —Å–ª–∏—à–∫–æ–º —Å–ª–∞–±—ã–º! –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:")
            st.markdown("""
            - –£–≤–µ–ª–∏—á–∏—Ç—å –±–∞–∑–æ–≤–æ–µ –∑–¥–æ—Ä–æ–≤—å–µ –Ω–∞ 15-20%
            - –î–æ–±–∞–≤–∏—Ç—å –ø–∞—Å—Å–∏–≤–Ω—É—é —Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏—é
            - –£–º–µ–Ω—å—à–∏—Ç—å —Å—Ç–æ–∏–º–æ—Å—Ç—å —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–µ–π
            """)
        elif delta < -4:
            st.warning("‚ö†Ô∏è **–í–Ω–∏–º–∞–Ω–∏–µ:** –ì–µ—Ä–æ–π –º–æ–∂–µ—Ç —Å—Ç–∞—Ç—å —Å–ª–∞–±–µ–µ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ. –†–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ:")
            st.markdown("""
            - –£–≤–µ–ª–∏—á–µ–Ω–∏–µ —É—Ä–æ–Ω–∞ –Ω–∞ 5-10%
            - –£–ª—É—á—à–µ–Ω–∏–µ –±–∞–∑–æ–≤—ã—Ö —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫
            """)
        else:
            st.success("‚úÖ **–û—Ç–ª–∏—á–Ω–æ!** –ü—Ä–µ–¥–ª–∞–≥–∞–µ–º—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ–º –¥–∏–∞–ø–∞–∑–æ–Ω–µ.")
            st.info("–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–º —Å–µ—Ä–≤–µ—Ä–µ –ø–µ—Ä–µ–¥ –≤—ã–ø—É—Å–∫–æ–º.")

# =================== –í–ö–õ–ê–î–ö–ê 3: –ì–ï–ù–ï–†–ê–¢–û–† –ö–û–ù–¢–ï–ù–¢–ê ===================
with tab3:
    st.header("–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –∏–≥—Ä–æ–≤–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞")
    
    item_type = st.selectbox("–¢–∏–ø –ø—Ä–µ–¥–º–µ—Ç–∞:", ["–û—Ä—É–∂–∏–µ", "–ë—Ä–æ–Ω—è", "–ê—Ä—Ç–µ—Ñ–∞–∫—Ç", "–ó–µ–ª—å–µ"])
    style = st.selectbox("–°—Ç–∏–ª—å –æ–ø–∏—Å–∞–Ω–∏—è:", ["–§—ç–Ω—Ç–µ–∑–∏", "–ö–∏–±–µ—Ä–ø–∞–Ω–∫", "–ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–π", "–ú–∏—Å—Ç–∏—á–µ—Å–∫–∏–π"])
    
    if st.button("–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–µ–¥–º–µ—Ç", type="primary"):
        st.subheader("üéâ –ù–æ–≤—ã–π –ø—Ä–µ–¥–º–µ—Ç —Å–æ–∑–¥–∞–Ω!")
        
        # –î–µ–º–æ-—Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏
        characteristics = {
            "–£—Ä–æ–Ω": random.randint(10, 100),
            "–ó–∞—â–∏—Ç–∞": random.randint(5, 50),
            "–†–µ–¥–∫–æ—Å—Ç—å": random.choice(["–û–±—ã—á–Ω—ã–π", "–†–µ–¥–∫–∏–π", "–≠–ø–∏—á–µ—Å–∫–∏–π", "–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π"]),
            "–°—Ç–æ–∏–º–æ—Å—Ç—å": random.randint(100, 1000)
        }
        
        # –î–µ–º–æ-–æ–ø–∏—Å–∞–Ω–∏–µ
        descriptions = {
            "–§—ç–Ω—Ç–µ–∑–∏": f"–î—Ä–µ–≤–Ω–∏–π {item_type.lower()}, –∏—Å–ø–µ—â—Ä—ë–Ω–Ω—ã–π —Ä—É–Ω–∞–º–∏ —ç–ª—å—Ñ–æ–≤. –ò–∑–ª—É—á–∞–µ—Ç –º—è–≥–∫–æ–µ —Å–≤–µ—á–µ–Ω–∏–µ.",
            "–ö–∏–±–µ—Ä–ø–∞–Ω–∫": f"–í—ã—Å–æ–∫–æ—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—á–Ω—ã–π {item_type.lower()} —Å –≥–æ–ª–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º. –ü–∏–∫—Å–µ–ª–∏ –º–µ—Ä—Ü–∞—é—Ç –Ω–µ–æ–Ω–æ–≤—ã–º —Å–≤–µ—Ç–æ–º.",
            "–ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–π": f"–ê—É—Ç–µ–Ω—Ç–∏—á–Ω—ã–π {item_type.lower()} —ç–ø–æ—Ö–∏ –≤–æ–∑—Ä–æ–∂–¥–µ–Ω–∏—è. –°–ª–µ–¥—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≥–æ–≤–æ—Ä—è—Ç –æ –º–Ω–æ–≥–∏—Ö –±–∏—Ç–≤–∞—Ö.",
            "–ú–∏—Å—Ç–∏—á–µ—Å–∫–∏–π": f"{item_type.capitalize()}, —Ö—Ä–∞–Ω—è—â–∏–π —Ç–∞–π–Ω—ã –¥—Ä–µ–≤–Ω–∏—Ö –∫—É–ª—å—Ç–æ–≤. –ü—Ä–∏ –∫–∞—Å–∞–Ω–∏–∏ —Å–ª—ã—à–µ–Ω —à—ë–ø–æ—Ç —Ç–µ–Ω–µ–π."
        }
        
        col1, col2 = st.columns(2)
        
        with col1:
            st.subheader("–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏")
            for key, value in characteristics.items():
                st.metric(key, value)
            
            # –û—Ü–µ–Ω–∫–∞ –±–∞–ª–∞–Ω—Å–∞
            balance_score = random.random()
            if balance_score > 0.7:
                st.success("‚úÖ –°–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω")
            elif balance_score > 0.4:
                st.warning("‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç –¥–æ—Ä–∞–±–æ—Ç–∫–∏")
            else:
                st.error("‚ùå –î–∏—Å–±–∞–ª–∞–Ω—Å")
        
        with col2:
            st.subheader("–û–ø–∏—Å–∞–Ω–∏–µ")
            st.info(descriptions[style])
            
            if style == "–ö–∏–±–µ—Ä–ø–∞–Ω–∫" and item_type == "–û—Ä—É–∂–∏–µ":
                st.warning("‚ö†Ô∏è –û–ø–∏—Å–∞–Ω–∏–µ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å—Ç–∏–ª—é –ö–∏–±–µ—Ä–ø–∞–Ω–∫ –¥–ª—è –æ—Ä—É–∂–∏—è. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ø–µ—Ä–µ–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å.")
                if st.button("–ü–µ—Ä–µ–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –æ–ø–∏—Å–∞–Ω–∏–µ"):
                    st.rerun()

# =================== –í–ö–õ–ê–î–ö–ê 4: –ó–ê–ì–†–£–ó–ö–ê –î–ê–ù–ù–´–• ===================
with tab4:
    st.header("–ó–∞–≥—Ä—É–∑–∫–∞ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö")
    
    data_source = st.radio("–ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö:", ["OpenDota API", "–õ–æ–∫–∞–ª—å–Ω—ã–π —Ñ–∞–π–ª", "–î–µ–º–æ-–¥–∞–Ω–Ω—ã–µ"])
    
    if data_source == "OpenDota API":
        matches_limit = st.number_input("–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–∞—Ç—á–µ–π:", min_value=10, max_value=10000, value=100)
        if st.button("–ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ —Å OpenDota"):
            with st.spinner("–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö..."):
                # –ò–º–∏—Ç–∞—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏
                import time
                time.sleep(2)
                st.success(f"‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ {matches_limit} –º–∞—Ç—á–µ–π")
    
    elif data_source == "–õ–æ–∫–∞–ª—å–Ω—ã–π —Ñ–∞–π–ª":
        uploaded_file = st.file_uploader("–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª (JSON, CSV)", type=["json", "csv"])
        if uploaded_file:
            st.success(f"‚úÖ –§–∞–π–ª {uploaded_file.name} –∑–∞–≥—Ä—É–∂–µ–Ω")
    
    else:
        st.info("–ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –¥–µ–º–æ-–¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.")
    
    if st.button("–ó–∞–ø—É—Å—Ç–∏—Ç—å ETL-–ø–∞–π–ø–ª–∞–π–Ω", type="primary"):
        progress_bar = st.progress(0)
        for i in range(100):
            # –ò–º–∏—Ç–∞—Ü–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞
            import time
            time.sleep(0.02)
            progress_bar.progress(i + 1)
        st.success("‚úÖ –î–∞–Ω–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã –∏ –≥–æ—Ç–æ–≤—ã –∫ –∞–Ω–∞–ª–∏–∑—É")

# =================== –§–£–¢–ï–† ===================
st.markdown("---")
st.caption("–ü—Ä–æ—Ç–æ—Ç–∏–ø –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –±–∞–ª–∞–Ω—Å–∞ –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–≥—Ä–æ–≤–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ | 2024")
